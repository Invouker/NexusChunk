<!DOCTYPE html>
<html lang="sk" xmlns:th="http://www.thymeleaf.org">
<head>
    <div th:replace="~{fragments/head :: head('NexusChunk Server | Vytvoriť Novinku', false)}"></div>

    <script src="https://cdn.tiny.cloud/1/no-api-key/tinymce/8/tinymce.min.js" referrerpolicy="origin" crossorigin="anonymous"></script>

    <link rel="stylesheet" th:href="@{/css/admin.style.css}">
</head>
<body>


<div class="admin-wrapper">

    <div th:replace="~{/admin/fragments/admin_navbar :: admin_navbar('news')}"></div>

    <div class="admin-main-content">
        <h1 class="section-title"><i class="fa-solid fa-square-plus"></i> Vytvoriť Nový Článok</h1>

        <div class="admin-card">
            <h4>Základné Informácie a Obsah</h4>

            <form th:action="@{/admin/news/save}" method="post" th:object="${news}" enctype="multipart/form-data">

                <input type="hidden" th:field="*{id}" />

                <div class="form-group" style="margin-bottom: 20px;">
                    <label for="title" class="stat-label" style="display: block; margin-bottom: 5px;">Titulok Článku:</label>
                    <input type="text" th:field="*{title}" id="title" placeholder="Zadajte pútavý titulok..." required class="form-control" style="width: 100%;">
                </div>

                <div class="dashboard-grid" style="grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">

                    <div class="form-group">
                        <label for="tags" class="stat-label" style="display: block; margin-bottom: 5px;">Tagy (oddelené čiarkou):</label>
                        <input type="text" id="tags" th:field="*{hashtags}"  placeholder="event, aktualizácia, súťaž" class="form-control" style="width: 100%;">
                    </div>
                </div>

                <div class="form-group" style="margin-bottom: 20px;">
                    <label for="thumbnailFile" class="stat-label" style="display: block; margin-bottom: 5px;">Nahrať Miniatúru/Obrázok (PNG, JPG):</label>
                    <input type="file" id="thumbnailFile" th:field="*{image}" accept="image/png, image/jpeg"
                           class="form-control" style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid var(--border-color); background-color: var(--bg-secondary); color: var(--text-light);">
                    <small style="color: var(--text-secondary); display: block; margin-top: 5px;">
                        Odporúčaná veľkosť: 16:9. Max. veľkosť súboru: 2MB.
                    </small>
                </div>

                <div class="form-group" style="margin-bottom: 30px;">
                    <label for="tiny" class="stat-label" style="display: block; margin-bottom: 5px;">Obsah Článku (podporuje Markdown/HTML):</label>
                    <textarea id="tiny" rows="15" th:field="*{content}"  placeholder="Sem napíšte hlavný text novinky..." required
                              class="form-control" style="width: 100%;"></textarea>
                </div>

                <div class="stat-group" style="width: 300px; border: none; padding: 0;">
                    <label class="stat-label" for="publishNow">Publikovať ihneď:</label>
                    <input type="checkbox" id="publishNow" th:field="*{published}"  checked>
                </div>

                <hr style="border-top: 1px solid var(--border-color); margin: 25px 0;">

                <p>
                    <button type="submit" class="btn-admin" style="background-color: var(--accent-color-success); margin-right: 15px;">
                        <i class="fa-solid fa-paper-plane"></i> Publikovať / Uložiť Zmeny
                    </button>
                    <a th:href="@{/admin/news}" class="btn-admin" style="background-color: var(--text-secondary);">
                        <i class="fa-solid fa-xmark"></i> Zrušiť
                    </a>
                </p>

            </form>
        </div>

    </div>
</div>

<script>
    $('textarea#tiny').tinymce({
        selector: 'textarea',
        plugins: [
            // Core editing features
            'anchor', 'autolink', 'charmap', 'codesample', 'emoticons', 'link', 'lists', 'media', 'searchreplace', 'table', 'visualblocks', 'wordcount',
            // Your account includes a free trial of TinyMCE premium features
            // Try the most popular premium features until Nov 21, 2025:
            'checklist', 'mediaembed', 'casechange', 'formatpainter', 'pageembed', 'a11ychecker', 'tinymcespellchecker', 'permanentpen', 'powerpaste', 'advtable', 'advcode', 'advtemplate', 'ai', 'uploadcare', 'mentions', 'tinycomments', 'tableofcontents', 'footnotes', 'mergetags', 'autocorrect', 'typography', 'inlinecss', 'markdown','importword', 'exportword', 'exportpdf'
        ],
        toolbar: 'undo redo | blocks fontfamily fontsize | bold italic underline strikethrough | link media table mergetags | addcomment showcomments | spellcheckdialog a11ycheck typography uploadcare | align lineheight | checklist numlist bullist indent outdent | emoticons charmap | removeformat',
        tinycomments_mode: 'embedded',
        tinycomments_author: 'Author name',
        mergetags_list: [
            { value: 'First.Name', title: 'First Name' },
            { value: 'Email', title: 'Email' },
        ],
        ai_request: (request, respondWith) => respondWith.string(() => Promise.reject('See docs to implement AI Assistant')),
        uploadcare_public_key: '29617635ee372847bb8e',
    });
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>

</body>
</html>